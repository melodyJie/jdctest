$(function(){var a={inputArr:$(".edit input"),isGenerate:false,init:function(){var b=this;b.bindHandler();},bindHandler:function(){var b=this;b.inputArr.on("input propertychange",function(){var d=$(this).val();var c=$(this).attr("data-preview");var e=$(".preview "+c);e.parent().show();console.log(e.parent());e.text(d);});b.inputArr.on("blur",function(){var d=$(this).val();var c=$(this).attr("data-preview");var e=$(".preview "+c);if(c.match("mood")){return;}if(d.length==0){e.parent().hide();}});$("#J_jobType").on("change",function(){var c=$(this).val();c="team-icon "+c;$(".team-icon").attr("class",c);});$("#J_teamType").on("change",function(){var c=$(this).find("option:selected").text();$(".team-type").text(c);});$("#J_teamOther input:checkbox").on("change",function(){var c=$(this).prop("checked");$("#J_teamType").prop("disabled",c);$("#J_teamOther input:text").prop("disabled",!c);if(c){$("#J_teamOther input:text").trigger("propertychange");}else{$("#J_teamType").change();}});$("#J_phoneNum").on("blur",function(){var h=$(this).val();var g=3,f=7,e=11;var d=e+2;if(h.length<e||h.length==d){return;}var c=h.substring(0,g)+"-"+h.substring(g,f)+"-"+h.substring(f,h.length);$(this).val(c);$(this).trigger("propertychange");});$("#J_clearContact").on("click",function(c){var d=$(".edit .input-contact");d.val("");d.trigger("blur");});$("#J_getSignImg").on("click",function(c){c.preventDefault();if(b.isGenerate){return;}b.isGenerate=true;$(this).text("正在生成签名...");$(this).addClass("disabled");b.generateImg();});$("#upload_image").fileupload({url:"uploadPic.php",dataType:"json",autoUpload:true,acceptFileTypes:/(\.|\/)(gif|jpe?g|png)$/i,maxFileSize:5000000,start:function(c){$(".upload-button").addClass("disabled");$("#upload_image").hide();$("#J_uploadDownload").addClass("loading");},done:function(f,d){var c=d.result;if(c.status=="success"){b.renderAvatar(c.url);}else{alert(c.msg);}$(".upload-button").removeClass("disabled");$("#upload_image").show();}});$("#J_avatarDefault img").on("click",function(){var c=$(this).attr("src");b.renderAvatar(c);});$(".dropdown-toggle").on("click",function(){var e=$(this).parent();var c=$(this).attr("data-toggle");var d=e.find("."+c+"-menu");d.toggle();});$("body").on("click",function(d){var c=$(d.target);if(c.hasClass("dropdown-toggle")||$(d.target).parents(".btn").length>0){return;}else{$(".dropdown-menu").hide();}});},renderAvatar:function(b){var c=new Date().getTime();$(".avatar img").attr("src",b+"?t="+c);},generateImg:function(){var c=this;var b="generateSign.php";$.ajax({url:b,type:"POST",data:{content:$(".sign-content").html()},success:function(d){c.renderSignImg(d);c.recoverBtn();}});},renderSignImg:function(b){var d=this;var c=$(".result");if(c.length==0){c=$('<div class="result clearfix"><h4>生成图片<em>（在下方图片上点击右键“保存”即可）</em></h4><span class="col-sm-2"></span><div class="col-sm-10"><img src="'+b+'"></div></div>');c.css("display","none");c.insertBefore(".preview");setTimeout(function(){c.slideDown(300);},100);}c.find("img").attr("src",b);},recoverBtn:function(){var c=this;c.isGenerate=false;var b=$("#J_getSignImg");b.text("生成签名");b.removeClass("disabled");}};a.init();});